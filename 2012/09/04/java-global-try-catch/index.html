<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:wb="http://open.weibo.com/wb">
<head>
<title>Lucas Xu : Java Global Try Catch </title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="language" content="en" />
<link rel="stylesheet" type="text/css" href="/css/default.css" />
<link rel="stylesheet" type="text/css" href="/css/syntax.css" />
<meta property="wb:webmaster" content="85ada6b02f0f02d5" />
<script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js?appkey=4064321344" type="text/javascript" charset="utf-8"></script>

<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32905076-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>














<body>
<div class="page_margins">
  <div id="header">
    <h2><a href="http://xianminx.github.com">Lucas Xu   徐仙明</a></h2>
    <div class="clear"></div>

    <!-- begin: main navigation #nav -->
    <div id="nav">
      <div class="hlist">
        <ul>
          
          <li>
          <a href="/about/">About</a>
          </li>
          
          <li class="active">
          <a href="/">Blog</a>
          </li>
          
          <li>
          <a href="/archives/">Archives</a>
          </li>
          
          <li>
          <a href="/tags/">Categories</a>
          </li>
          
          <li>
          <a href="/other/">Other</a>
          </li>
          
        </ul>
      </div>
    </div>
    <!-- end: main navigation -->
  </div>

  <!-- begin: main content area #main -->
  <div id="main">
    <div id="col1">
      <div id="col1_content">
        <div class="post">
  <h3>Java Global Try Catch</h3>


<!-- JiaThis Button BEGIN -->
<div id="ckepop">
  <span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_tsina">新浪微博</a>
	<a class="jiathis_button_googleplus">Google+</a>
	<a class="jiathis_button_fb">Facebook</a>
	<a class="jiathis_button_evernote">EverNote</a>
	<a class="jiathis_button_tqq">腾讯微博</a>
	<a href="http://www.jiathis.com/share?uid=1633146" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
	<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript">var jiathis_config = {data_track_clickback:true};</script>
<script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js?uid=1336370704363698" charset="utf-8"></script>
<!-- JiaThis Button END -->
<!-- UJian Button BEGIN -->
	<script type="text/javascript" src="http://v1.ujian.cc/code/ujian.js?type=slide"></script>
<!-- UJian Button END -->

<script type="text/javascript">
var jiathis_config = {
    shareImg:{
        "showType":"ALL",
        "bgColor":"",
        "txtColor":"",
        "text":"",
        "services":"",
        "position":"",
        "imgwidth":"",
        "imgheight":"",
        "divname":""
    }
}
</script>
<script type='text/javascript' src='http://v2.jiathis.com/code/jia.js?uid=1336370704363698' charset='utf-8'></script>



<br/>

  <p>Java 为程序员提供了非常方便的错误处理。当有某段代码可能会发生错误， 比如读文件不存在， 所写的代码就不能正常工作。 这种情况下， 通常需要附加的逻辑来处理错误情况。 直接的方式是将可能会发生错误的代码段用<code>try {}</code>包起来。 在<code>catch</code> 中处理错误发生之后的逻辑， 使得整体程序不至于崩溃。 </p>

<h2 id="toc_41">Java Exception Handling</h2>

<p>Java 提供<code>try  catch</code> 机制来捕获异常，方便程序员处理。
<code>java
try {
  // code that may break
  //...
}
catch (Exception e){
  // to handle the exception here. 
  // Usaually, just print out the exception stacktrace. 
  e.printStackTrace();
}
</code></p>

<h3 id="toc_42">一个简单的例子</h3>

<p>下面的代码演示了<code>try catch</code> 的简单使用：</p>

<h2 id="toc_43">Global try catch?</h2>

<p>Java 程序员被要求在所有可能发生问题的代码段都要加上<code>try catch</code>. 幸好编译器有时会提醒你哪里需要添加。 对于一个不那么自信的程序员， 是不是需要在所有的代码块都加上<code>try catch</code> 呢？ 天哪， 那样的代码还能用吗？能用的话， 即使程序不会崩溃， 也不能完成正常的功能吧。 </p>

<p>在某些情况下， 你可能希望有一个全局的错误处理机制。 如果发生了某个你不能预料的错误，比如你的程序本来运行的好好的， 但是被某些杀毒软件强行夺取了某个文件的访问权限， 这时使得你的程序处于一个不稳定的状态，然后程序崩溃了。 这怎么办？ 你会难道要责怪用户吗？ 
或许有更好的选择。 </p>

<p>当这种不能预料的错误发生时， 你希望能有一个全局的默认的错误处理机制，让程序在错误发生时依然可以做些恢复工作， 至少可以提醒用户为什么出错了。 </p>

<p>这就是Global Exeption Handler 的作用。 </p>

<p>Java 对于线程提供了一个方法
 <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#setDefaultUncaughtExceptionHandler(java.lang.Thread.UncaughtExceptionHandler)">setDefaultUncaughtExceptionHandler</a></p>

<p>下面是其说明
&gt;
&gt;public static void setDefaultUncaughtExceptionHandler(Thread.UncaughtExceptionHandler eh)</p>

<blockquote>
<p>Set the default handler invoked when a thread abruptly terminates due to an uncaught exception, and no other handler has been defined for that thread.
Uncaught exception handling is controlled first by the thread, then by the thread&#39;s ThreadGroup object and finally by the default uncaught exception handler. If the thread does not have an explicit uncaught exception handler set, and the thread&#39;s thread group (including parent thread groups) does not specialize its uncaughtException method, then the default handler&#39;s uncaughtException method will be invoked.</p>

<p>By setting the default uncaught exception handler, an application can change the way in which uncaught exceptions are handled (such as logging to a specific device, or file) for those threads that would already accept whatever &quot;default&quot; behavior the system provided.</p>

<p>Note that the default uncaught exception handler should not usually defer to the thread&#39;s ThreadGroup object, as that could cause infinite recursion.</p>

<p>Parameters:
eh - the object to use as the default uncaught exception handler. If null then there is no default handler.</p>

<p>Throws:
SecurityException - if a security manager is present and it denies RuntimePermission (&quot;setDefaultUncaughtExceptionHandler&quot;)
Since:
1.5</p>
</blockquote>

<p>The following <a href="http://www.nomachetejuggling.com/2006/06/13/java-5-global-exception-handling/">code</a> illustrates an example:</p>

<h2 id="toc_44">Migrate to Android</h2>

<p>There are already many threads discussing the topic on StackOverflow:</p>

<ul>
<li><a href="http://stackoverflow.com/questions/2764394/ideal-way-to-set-global-uncaught-exception-handler-in-android">Ideal way to set global uncaught exception Handler in Android</a></li>
<li><a href="http://stackoverflow.com/questions/5740843/android-global-error-handling-and-reporting-activity">Android Global Error Handling and Reporting Activity</a></li>
</ul>

<p>The steps to take are quite similar to those of Java. </p>

<p><a href="http://stackoverflow.com/questions/5740843/android-global-error-handling-and-reporting-activity?answertab=votes#tab-top">Something</a> to take care: 
&gt; 
When implementing ACRA, I have never been able to start a new Activity after receiving an uncaught exception. It looks like the whole process is switched by the system to a special state preventing him from allowing any new resource.
&gt;
The only option I have found for the moment is to send a status bar notification which is kept by the system after the application being restarted. The notification then triggers an intent for a dialog activity when the user selects it.
&gt;
Alexey Yakovlev studied in much more details this issue and came to the conclusion that there could be a chance of triggering a new activity when the crash occurs on a thread which is not the UI thread. Though we did not find a simple enough workaround to start directly an activity in all cases.
&gt;
I got rid of the default force close dialog by killing the process myself without invoking the orginial default uncaught exception handler.
&gt;</p>

<h2 id="toc_45">Trap, Be careful</h2>

<h2 id="toc_46">References</h2>

<ul>
<li><a href="http://metatations.com/2011/11/20/global-exception-handling-in-java/">global exception handling in Java</a></li>
</ul>

</div>

<small class="meta final">
  04 Sep 2012
  
   | 
  <a href='/tags#java'>java</a>, 
  
  
  <a href='/tags#exception'>exception</a>
  

</small>
<!-- 新浪微薄 评论箱 -->
<script type="text/javascript">
(function(){
var url = "http://widget.weibo.com/distribution/comments.php?width=0&url=auto&ralateuid=2063991842&appkey=4064321344&dpc=1";
url = url.replace("url=auto", "url=" + document.URL); 
document.write('<iframe id="WBCommentFrame" src="' + url + '" scrolling="no" frameborder="0" style="width:100%"></iframe>');
})();
</script>
<script src="http://tjs.sjs.sinajs.cn/open/widget/js/widget/comment.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
window.WBComment.init({
    "id": "WBCommentFrame"
});
</script>
<!-- 新浪微薄 评论箱 -->


<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32905076-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

      </div>
    </div>
    <div id="col3">
      <div id="col3_content">
        <h6 class="vlist">GitHub projects</h6>
        <ul class="vlist">
        	<li>
			<a href="https://github.com/xianminx/PullToRefresh-ListView" >PullToRefresh-ListView</a>
		</li>
	</ul>
        <h6 class="vlist">Misc. Links</h6>
        <ul class="vlist">
          <li>
            <a
              href="http://android-developers.blogspot.com/"
              ><img src="http://android-developers.blogspot.kr/favicon.ico"/>Android Developers Blog</a>
          </li>
           <li>
            <a
              href="http://saigeethamn.blogspot.com/"
              ><img src="https://www.blogger.com/img/logo-16.png"/> Sai Geetha's Android blog</a>
          </li>
          <li>
            <a
              href="http://jon.oberheide.org/blog/"
              ><img src="https://encrypted-tbn2.google.com/images?q=tbn:ANd9GcRo9pLd2k2lx_xG3T0uA7DgpZ0Guu9FMWHPLi5cDeVayZ7uNO0X" height="16" width="16"/>JON.OBERHEIDE.ORG</a>
          </li>
          </ul>

<!-- AddThis Follow BEGIN -->
<h6 class="vlist">Follow Me</h6>
<br/>
<div class="addthis_toolbox addthis_32x32_style addthis_default_style">
<a class="addthis_button_google_follow" addthis:userid="101226668323584222394"></a>
<a class="addthis_button_facebook_follow" addthis:userid="xianminx"></a>
<a class="addthis_button_linkedin_follow" addthis:userid="xianminx"></a>
<a class="addthis_button_twitter_follow" addthis:userid="xianminx"></a>
</div>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=ra-4fdf49b46dac2571"></script>
<!-- AddThis Follow END -->

<br/>

<iframe width="100%" height="550" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=1&ptype=1&speed=300&skin=1&isTitle=1&noborder=0&isWeibo=1&isFans=1&uid=2063991842&verifier=e0e8dc08&dpc=1"></iframe>


</div>
    </div>
    <div class="clear"></div>
  </div>
  <!-- end: #main -->

  <!-- begin: #footer -->
  <div id="footer">
    <div class="hlist">
      <ul>
        
        <li>
        <a href="/about/"
        
        >About</a>
         | 
        </li>
        
        <li class="active">
        <a href="/"
        
        >Blog</a>
         | 
        </li>
        
        <li>
        <a href="/archives/"
        
        >Archives</a>
         | 
        </li>
        
        <li>
        <a href="/tags/"
        
        >Categories</a>
         | 
        </li>
        
        <li>
        <a href="/other/"
        
        >Other</a>
        
        </li>
        
        <li>&ndash; updated 2013-02-02</li>
      </ul>
    </div>
  </div>
  <!-- end: #footer -->

</div>

</body>
</html>
